{"data":{"edges":[],"nodes":[{"data":{"id":"ChromaViewChunks-MSYPC","node":{"template":{"_type":"CustomComponent","code":{"type":"code","required":true,"placeholder":"","list":false,"show":true,"multiline":true,"value":"from langflow import CustomComponent\r\nfrom langflow.schema import Message\r\nfrom langflow.inputs import StrInput\r\nfrom chromadb import Client\r\nfrom chromadb.config import Settings\r\n\r\n# Componente criado por Pedro Collares Xavier\r\n\r\nclass ChromaViewChunks(CustomComponent):\r\n    display_name = \"Visualizar Chunks no ChromaDB\"\r\n    description = \"Lista os documentos (chunks) salvos dentro de uma coleção do ChromaDB.\"\r\n    icon = \"ChromaDB\"\r\n\r\n    def build_config(self):\r\n        return {\r\n            \"collection_name\": StrInput(\r\n                display_name=\"Nome da Coleção\",\r\n                name=\"collection_name\",\r\n                required=True,\r\n                info=\"Nome da coleção de onde os chunks serão lidos.\"\r\n            ).to_dict(),\r\n            \"persist_directory\": StrInput(\r\n                display_name=\"Diretório de Dados\",\r\n                value=\"/app/chromadb\",\r\n                name=\"persist_directory\"\r\n            ).to_dict(),\r\n        }\r\n\r\n    def build(self, collection_name: str, persist_directory: str, **kwargs) -> Message:\r\n        try:\r\n            client = Client(Settings(\r\n                persist_directory=persist_directory,\r\n                is_persistent=True\r\n            ))\r\n\r\n            collection = client.get_collection(name=collection_name)\r\n            if not collection:\r\n                return Message(text=f\"Coleção '{collection_name}' não encontrada.\")\r\n\r\n            # Buscar todos os documentos (limite arbitrário ajustável)\r\n            results = collection.get()\r\n            documents = results.get(\"documents\", [])\r\n            ids = results.get(\"ids\", [])\r\n\r\n            if not documents:\r\n                return Message(text=f\"Nenhum chunk encontrado na coleção '{collection_name}'.\")\r\n\r\n            preview_text = \"\\n\\n\".join(\r\n                [f\"--- Chunk {i+1} (ID: {ids[i]}): ---\\n{doc}\" for i, doc in enumerate(documents)]\r\n            )\r\n\r\n            return Message(\r\n                text=f\"Chunks encontrados na coleção '{collection_name}':\\n\\n{preview_text[:4000]}\",\r\n                data={\"total_chunks\": len(documents), \"chunks_preview\": preview_text[:4000]}\r\n            )\r\n\r\n        except Exception as e:\r\n            return Message(text=f\"⚠️ Erro ao acessar coleção: {str(e)}\")\r\n","fileTypes":[],"file_path":"","password":false,"name":"code","advanced":true,"dynamic":true,"info":"","load_from_db":false,"title_case":false},"collection_name":{"type":"str","required":true,"placeholder":"","list":false,"show":true,"multiline":false,"value":"CompletoV3","fileTypes":[],"file_path":"","name":"collection_name","display_name":"Nome da Coleção","advanced":false,"dynamic":false,"info":"Nome da coleção de onde os chunks serão lidos.","load_from_db":false,"title_case":false,"input_types":["Text"]},"persist_directory":{"type":"str","required":false,"placeholder":"","list":false,"show":true,"multiline":false,"value":"/app/chroma","fileTypes":[],"file_path":"","name":"persist_directory","display_name":"Diretório de Dados","advanced":false,"dynamic":false,"info":"","load_from_db":false,"title_case":false,"input_types":["Text"]}},"description":"Lista os documentos (chunks) salvos dentro de uma coleção do ChromaDB.","icon":"ChromaDB","base_classes":["Data","Message"],"display_name":"Visualizar Chunks no ChromaDB","documentation":"","minimized":false,"custom_fields":{"collection_name":null,"persist_directory":null},"output_types":["Message"],"pinned":false,"conditional_paths":[],"frozen":false,"outputs":[{"types":["Message"],"selected":"Message","name":"message","hidden":null,"display_name":"Message","method":null,"value":"__UNDEFINED__","cache":true,"required_inputs":null,"allows_loop":false,"options":null,"tool_mode":true}],"field_order":[],"beta":false,"legacy":false,"edited":true,"metadata":{},"tool_mode":false,"official":false},"showNode":true,"type":"ChromaViewChunks"},"id":"ChromaViewChunks-MSYPC","position":{"x":0,"y":0},"type":"genericNode"}],"viewport":{"x":1,"y":1,"zoom":1}},"description":"Lista os documentos (chunks) salvos dentro de uma coleção do ChromaDB.","name":"Visualizar Chunks no ChromaDB","id":"ChromaViewChunks-MSYPC","is_component":true,"last_tested_version":"1.4.3"}